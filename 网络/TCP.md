1.拥塞控制

拥塞问题的是指往往是整个系统的各个部分不匹配，只有各个部分平衡了，问题才会得到解决。

所谓拥塞控制就是防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不致过载。拥塞控制所要做的都有一个前提，就是网络能承受现有的网络负荷。拥塞问题是一个全局性的问题,涉及到所有的主机、所有的路由器、以及与降低网络传输性能有关的所有因素。

提高网络利用率，降低丢包率，并保证网络资源对每条数据流的公平性，这就是拥塞控制。 
**拥塞控制包括四部分：慢启动、拥塞避免、快速重传、快速恢复** 。

**慢启动:**

可能因为不清楚当前网络的负荷情况而引起网络阻塞。所以，最好的方法是先探测一下，即由小到大逐渐增大发送窗口，也就是说，由小到大逐渐增大拥塞窗口数值。而在每收到一个新的报文段的确认后，把拥塞窗口增加至多一个MSS的数值。用这样的方法逐步增大发送方的拥塞窗口cwnd，可以使分组注入到网络的速率更加合理。慢开始当中的“慢”并不是指cwnd的增长速率慢，而是在TCP开始发送报文段时先设置cwnd = 1,使得发送方在开始时只发送一一个报文段）cwnd按指数规律增长。

当cwnd足够大的时候，为了防止拥塞窗口cwnd的增长引起网络阻塞，还需要另外一个变量------慢开始门限ssthresh.

​    i.当cwnd < ssthresh时，使用上述慢启动算法；

​    ii.当cwnd >ssthresh时，停止使用慢启动算法，改用拥塞避免算法；

拥塞避免：

让拥塞窗口cwnd缓慢的增大，即每经过一个往返时间RTT就把发送方的拥塞窗口cwnd加1，而不是加倍，这样拥塞窗口cwnd按线性规律缓慢的增长，比慢开始算法的拥塞窗口增长速率缓慢的多。

快重传:

一条TCP连接有时会因为等待重传计时的超时而空闲较长时间，慢开始和拥塞避免无法解决这类问题，因此提出了快重传和快恢复的拥塞控制方法。



快恢复:



2.流量控制

流量控制往往指的是点对点通信量的控制，是个端到端的问题。流量控制所要做的就是控制发送端发送数据的速率，以便使接收端来得及接受。

如果发送端发送数据太快，接收端来不及接收，可能会丢失数据。所以流量控制是让发送端不要发送太快，要让接收端来得及接收 。
**流量控制是通过大小可变的滑动窗口实现的。** 

发送端窗口大小不能超过接收端窗口大小的值。TCP窗口单位是字节。 
为什么要设置窗口，因为如果TCP发完一次数据等待接收端确认再发下一条数据太慢了/让发送方的发送速率不要太快，让接收方来得及接受。 



#### 为什么长度8要变成红黑树?

简单解释一下，理想情况下，在随机哈希代码下，桶中的节点频率遵循
泊松分布，文中给出了桶长度k的频率表。
由频率表可以看出，桶的长度超过8的概率非常非常小。所以作者应该是根据
概率统计而选择了8作为阀值。

(简单来说就是概率算出的，超过8的可能性非常小)