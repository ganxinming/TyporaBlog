#### redis集群选举：

当redis集群的主节点故障时，redis集群将从剩余的从节点中选举一个新的主节点，有以下步骤：

1. 故障节点主观下线
2. 故障节点客观下线   
3. redis集群选举Leader
4. slave决定新主节点

#### **故障节点主观下线：**

redis中每个节点会向其他节点发送心跳包，如果没有接到心跳包反馈，则主观认为那个节点下线了，但此时可能那个并没有下线，可能只是网络的问题。所以称为主观下线。

#### 故障节点客观下线  ：

如果判断为主观下线，则会询问其他节点，那个节点是不是挂了啊？如果数量大于一半，则认为该节点下线。

#### redis集群选举Leader：

每一个slave节点都可以成为Leader，当一个slave节点确认redis集群的主节点主观下线后，会请求其他slave节点要求将自己选举为Leader。被请求的Sentinel节点如果没有同意过其他Sentinel节点的选举请求，则同意该请求(选举票数+1)，否则不同意。

如果一个slave节点获得的选举票数达到Leader最低票数(quorum和Sentinel节点数/2+1的最大值)，则该Sentinel节点选举为Leader；否则重新进行选举。



### redis节点数：

##### 为什么redis集群至少3节点？redis集群允许1个redis节点故障则需要3个节点的集群；允许2个节点故障则需要5个节点集群。